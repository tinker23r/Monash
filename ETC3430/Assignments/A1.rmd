---
title: "ETC3430 Assignment 1"
author: "Chelaka Paranahewa"
output: 
  html_document:
    fig_crop: false
    
---
    
```{r Setup}
library(tidyverse)
library(readxl)
library(expm)
setwd("C:/Users/chela/GitHub Local Repo/Uni-Work/ETC3430/Assignments/")
set.seed(31455034)
```

# Question 1
## Part E
```{r, fig.width = 9, fig.height = 5, warning=FALSE}
set.seed(3149)
P <- matrix(
    data = c(0.45, 0.35, 0.20, 0.36, 0.34, 0.30, 0.25, 0.65, 0.10),
    nrow = 3, ncol = 3, byrow = TRUE
)

# Cumulative Probability
CP <- t(apply(P, 1, cumsum))
n <- 100

repeater <- function(sim_size) {
    X <- matrix(0, sim_size + 1, 1)
    X[1, 1] <- 1
    for (day in 1:3) {
        for (i in 1:sim_size) {
            u <- runif(1)
            X[i + 1, 1] <- 1 * (u < CP[X[i, 1], 1]) +
                2 * (u < CP[X[i, 1], 2]) * (u > CP[X[i, 1], 1]) +
                3 * (u > CP[X[i, 1], 2])
        }

        g <- X %>%
            as_tibble() %>%
            ggplot(aes(x = V1)) +
            geom_histogram() +
            labs(
                title = paste("Day ", day),
                subtitle = paste("n =  ", sim_size),
                x = "State"
            )
        print(g)
    }
}
sims <- c(100, 1000, 10000, 100000)
for (index in 1:4) {
   repeater(sims[index])
   print(index)
}
```